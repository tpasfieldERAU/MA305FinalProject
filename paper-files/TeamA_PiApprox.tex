% Latex template for MA305 Project Report, Fall 2022
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[11pt]{article}
\usepackage{graphicx}
\usepackage[pdftex]{color}
\usepackage{multicol}
\newcommand{\cred} {\textcolor{red}}
\usepackage{fancyhdr}
\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} 	% Horizontal rule 
\usepackage{listings}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\lstdefinestyle{mystyle}{
	backgroundcolor=\color{backcolour},   
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\footnotesize,
	breakatwhitespace=false,         
	breaklines=true,                 
	captionpos=b,                    
	keepspaces=true,                 
	numbers=left,                    
	numbersep=5pt,                  
	showspaces=false,                
	showstringspaces=false,
	showtabs=false,                  
	tabsize=2
}
\lstset{style=mystyle}


\begin{document}

%%%%%%%%%% TITLE PAGE %%%%%%%%%%
\begin{center}
{\it MA305, Fall 2022  \hfill Embry-Riddle Aeronautical University
 }\\
		\horrule{0.5pt} \\[0.4cm]
		\textcolor{blue}{\bf \Large  % change this
			Computational Methods for $\pi$ in Python
			}\\
		\horrule{2pt} \\[5cm]
%%%%%%%%%%%%%%%%%%%%
		Thomas Pasfield, Omar Alhomaidah, Owen Mudgett  % change this
\\[0.4cm]
\today % change this. To due date?
\end{center}
\thispagestyle{empty}
\newpage
\begin{abstract}
\end{abstract}
\tableofcontents 
\newpage

%%%%%%%%%%  %%%%%%%%%%
\section{Introduction}\label{S:1}
%The text of this section.
% Write a brief description (background/significance) of what the project is about. \\

Pi is an extremely useful number, being fundamental to mathematics for so much more than just geometry, and having extensive applications in physics. It is simply the ratio of the circumference of a circle and the diameter of the circle, yet applies to so much more. Being such a useful number, it is important that we have an accurate value for it, and can calculate it as needed. This paper explores different methods of these calculations, using three categories of methods. These categories are numerical integration, sum of alternating series, and Monte Carlo integration.


\section{Problem Statement}\label{S:2}
%The text of this section. 
% Explain meaning of all symbols used. Make clear what is given and what we are looking for. 
The goal is to approximate $\pi$ with Python using different methods, and to provide an analysis of the methods relative to each other. The code must accept a number of iterations, the ''N-value'', and run each method using that value. 

\section{Method/Analysis}\label{S:3}
%Text introducing this section
% Begin with naming or characterizing the method/approach to be used, perhaps explain the basic idea behind it, to what type of problems it applies, under what conditions, what it achieves, what are its main features, advantages, disadvantages. Justify why it is applicable to this problem, stating clearly any assumptions you need to make about the problem for the method to apply. Name some other methods/approaches one could use, and if/why your method may be preferable.


\subsection{Numerical Integration}\label{S:3.1}
For some problems we can’t integrate the function. Instead, we need to approximate the integration. So, we use what we call numerical integration. When we are provided a set of data rather than an explicit function or when it is challenging to locate the antiderivative of the integrand, we apply numerical integration. When it is difficult to identify a closed form of an integral or when we simply need an approximation of the integral value, we typically employ numerical integration to estimate its values.\\

The midpoint rule, trapezoidal rule, and Simpson's rule are the methods for numerical integration that are most frequently used.\\

Two functions are provided for this task.
\[
	\int_0^1 4\sqrt{1-x^2}dx
\]
\[
	\int_{-1}^{1} \frac{1}{\sqrt{1-x^2}}dx
\]

\subsubsection*{Trapezoid Rule}
The Trapezoidal Rule divides the whole area into smaller trapezoids rather than utilizing rectangles to calculate the area under the curves. This integration determines the area by approximating the region underlying a function's graph as a trapezoid. The left and right sums are averaged out according to this rule.\\

ADD FIGURES\\

As we see from the figure above, we pick points where $\Delta x$ intersect and use these values to solve for the trapezoid function.

Trapezoid Function:
\[
	\int_a^b f(x)dx \approx \Delta \left(\frac{1}{2} f(x_0) + \Sigma_{i=1}^{N-1}f(x_i)+\frac{1}{2}f(x_n)\right)
\]
where $\Delta x = \frac{b - a}{n}$ and $x_i = a + i\Delta x$

Ex.\\
\[T_n=\frac{\Delta x}{2}\left(f(x_0) + 2f(x_1) + 2f(x_{n-1} + f(x_n)\right)\]
\[T_{10}=\frac{\Delta x}{2}\left(f(0) + 2f(0.1) + 2f(0.2) + \cdots + f(1)\right)\]
\[T_{10}=\frac{0.1}{2}\left(4\sqrt{1-0} 4\sqrt{1-0.1^2} + 4\sqrt{1-0.2^2}+\cdots+4\sqrt{1-1^2}\right)\]
\[T_{10}=3.1045\]

\subsubsection*{Simpson's $\frac{1}{3}$ Rule}
The errors for the midpoint and trapezoid rules behave in a highly predictable manner if the function is not linear on a subinterval; they have the opposite sign. For instance, the trapezoid will be too high and the midpoint will be too low if the function is concave up. Thus, it makes reasonable that averaging the trapezoid and midpoint would give a more accurate estimate. However, we can perform better in this instance than a simple average. Using a weighted average will reduce the error. We employ Simpson's, a quadratic polynomial function, to get the appropriate weight.\\

ADD FIGURES\\

As we see from the figure above, we will have the same point as trapezoid where we pick points that $\Delta x$ intersect and use these values to evaluate the Simpson’s function.\\

Simpson's Function:
\[
	\int_a^b f(x)dx \approx \frac{\Delta x}{3} \left(f(x_0) + 4\Sigma_{i=1,3,5}^{N-1}f(x_i)+2\Sigma_{i=2,4,6}^{N-2}f(x_i)+f(x_n)\right)
\]
where $\Delta x = \frac{b - a}{n}$ and $x_i = a + i\Delta x$

\subsubsection*{Midpoint Rule}
We run the risk of the values at the endpoints not accurately representing the average value of the function on the subinterval if we use the endpoints of the subintervals to approximate the integral. The midpoint of each subinterval is a location that is significantly more likely to be close to the average.  The midpoint of every subinterval is used here to calculate the sum.\\

ADD FIGURES\\

In the midpoint method, we use the points that occur between $\Delta x$ values and use these in the Midpoint function to find a solution.

Midpoint Function:
\[
	\int_a^b f(x)dx \approx \Delta x \Sigma_{i=1}^Nf(x_i)
\]
where $\Delta x = \frac{b - a}{n}$ and $x_i = a + i\Delta x$

\subsubsection*{Comparison}
ADD FIGURES \\

While the trapezoidal rule uses trapezoidal approximations to estimate the definite integral, the midpoint rule uses rectangular regions to do so. Simpson's rule approximates the original function using quadratic polynomials, then it approximates the definite integral.
When the underlying function is smooth, the trapezoidal rule does not provide an accurate number like Simpson’s or midpoint rules do. This is due to the fact that Simpson’s rule employs quadratic approximation rather than linear approximation. All three methods produce a good approximation for the integrals. Midpoint was the best approximation for our problem, then Simpson’s was very close to it and lastly trapezoid was the least accurate method.\\

\subsection{Sum of Alternating Series}\label{S:3.2}
\subsubsection*{Alternating Series}
\[\tan^{-1}x = x - \frac{x^3}{3} + \frac{x^5}{5} - \cdots \approx \Sigma_{n=1}^N(-1)^{n+1}\frac{x^{2n-1}}{2n-1}\]

The first alternating sum method uses  the alternating series of arctan. Multiplying the series by 4 with an x value of 1 over N iterations approximates $\pi$. This method is fairly accurate, but has a strange interaction with N values that are exponentiations of 10. Whichever place N occupies - for example, 1000 in the thousands - the digit in the thousandths place in $\pi$ will be undershot. N = 1000 gives a $\pi$ value of 3.140592653840, which is accurate up to 3.141592653 except for the thousandths place.\\

\subsubsection*{Machin's Formula}
\[4\left(4\tan^{-1}(\frac{1}{5})-\tan^{-1}(\frac{1}{239})\right) = \pi\]

The second alternating sum method uses arctan again, but twice each with different x values. John Machin created the formula in 1706, and has been widely used since then due to how fast the series converges to $\pi$ (Nishiyama). The first arctan function is multiplied by 16 and uses x = $\frac{1}{5}$, and the second arctan (subtracted from the first) is multiplied by 4 and uses x = $\frac{1}{239}$. Overall, this method is more accurate than normal 4 * arctan(1,N), but takes slightly longer.\\

\subsubsection*{Madhava's Series}
\[\sqrt{12}\left(1 - \frac{1}{3\cdot 3} + \frac{1}{5\cdot 3^2} - \frac{1}{7\cdot 3^3} + \cdots\right) = \pi\]

he third alternating sum method uses what’s called Madhava’s Series, with is the square root of 12 multiplied by the the series:

\[\Sigma(-1)^{n+1} / (2n-1)(3^{n-1})\]

starting at n = 1.\\

This one is faster than the other two, but takes many more iterations before it reaches accurate digits of $\pi$.

\subsection{Monte Carlo Integration}\label{S:3.3}
A Monte Carlo estimator is a method of approximating an explicit value using randomness. They are useful for getting a rough idea of an outcome, rather than getting an exact or accurate one. 

\subsubsection*{Area Method}
The ratio between the area of a circle and the area of the square bounding it equals $\pi$.

\[\frac{A_{circle}}{A_{square}}=\frac{\pi r^2}{4 r^2} = \frac{\pi}{4}\]

This ratio is for each unit of the total area, and is maintained when approximated using randomly distributed points within it.

\subsubsection*{Volume Method}
Like the area method, a ratio can be found relative to pi using a sphere, a cone, and a cube.
\[\frac{(V_{sphere}-V_{cone})}{V_{cube}}=\frac{\left(\frac{4}{3}\pi r^3 - \frac{1}{3}\pi r^2 h\right)}{8r^3}=\frac{\pi}{8}\]

Also like the area method, the ratio is maintained for each unit of volume, so the ratio can be multiplied by the volume of the cube, 8, to find $\pi$.

\section{Solutions/Results}\label{S:4}
%Text introducing this section
% This section contains the presentation of your solution and results.
% Describe your implementation of the method(s) for this specific problem, any special features, numerical methods implementation  strategy, choices of any parameters, stopping criteria, etc.
% Present the results in words and plots (annotate by hand if necessary), explain what they mean. Include your code in an Appendix. 
\begin{table}[!ht]
    \centering
    \makebox[\textwidth]{\begin{tabular}{|l|l|l|l|l|l|l|l|l|}
    \hline
        Iterations & Midpoint & Simpson's & Trapezoid & Arctan & Machin's & Madhava & Area & Volume \\ \hline
        1 & 3.464102 & 1.333333 & 2.000000 & 4.000000 & 3.183264 & 3.464102 & 4.000000 & 4.000000 \\ \hline
        2 & 3.259367 & 2.976068 & 2.732051 & 2.666667 & 3.140597 & 3.079201 & 4.000000 & 5.333333 \\ \hline
        4 & 3.183929 & 3.083595 & 2.995709 & 2.895238 & 3.141592 & 3.137853 & 4.000000 & 3.200000 \\ \hline
        8 & 3.156687 & 3.121189 & 3.089819 & 3.017072 & 3.141593 & 3.141569 & 3.111111 & 1.777778 \\ \hline
        16 & 3.146952 & 3.134398 & 3.123253 & 3.079153 & 3.141593 & 3.141593 & 2.588235 & 1.882353 \\ \hline
        32 & 3.143491 & 3.139052 & 3.135102 & 3.110350 & 3.141593 & 3.141593 & 2.909091 & 2.909091 \\ \hline
        64 & 3.142265 & 3.140695 & 3.139297 & 3.125969 & 3.141593 & 3.141593 & 3.200000 & 2.830769 \\ \hline
        128 & 3.141830 & 3.141275 & 3.140781 & 3.133780 & 3.141593 & 3.141593 & 3.162791 & 3.286822 \\ \hline
        256 & 3.141677 & 3.141481 & 3.141306 & 3.137686 & 3.141593 & 3.141593 & 3.143969 & 3.175097 \\ \hline
        512 & 3.141622 & 3.141553 & 3.141491 & 3.139640 & 3.141593 & 3.141593 & 3.150097 & 3.134503 \\ \hline
        1000 & 3.141604 & 3.141578 & 3.141555 & 3.140593 & 3.141593 & 3.141593 & 3.152000 & 3.248000 \\ \hline
    \end{tabular}}
\end{table}
\subsection{A subsection}
%
Text introducing this subsection. 

\subsubsection{A subsubsection}
%
Text introducing this subsubsection. 

\subsubsection{A further subdivision}
%
Text introducing this subsubsection. 

\section{Discussion/Conclusions}\label{S:5}
%Text introducing this subsection
Interpret your solution physically, what we learn from it, comment on strengths and weaknesses of the solution method, any nice features you want to brag about, possible ways to improve it (e.g. how to make it more accurate, more efficient), as appropriate.


\begin{thebibliography}{100}
%List the materials used in the project. e.g., books, papers, web resources, codes, etc. 	
\bibitem{a1}  
Heath, Michael T., Scientific Computing: An Introductory Survey, McGraw Hill, 2002.
%
%\bibitem{a2}
%
%\bibitem{a3} 

\end{thebibliography}
%\end{document}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% section Appendix %%%%%%%%%%%%%%%%%%%%%
\newpage
\appendix 
\setcounter{section}{0}           
\section{Python Codes}\label{S:A}
%
Text introducing this appendix. Subsections and further divisions can also be used in appendices. 

\begin{lstlisting}[language=Python]
#!/usr/bin/env python3 
import math

"""
=================================================================
MA305 - cw #: your name - date
Purpose: Find the number of trailing zeros in factorial(n). 
=================================================================
"""

n=input('Enter a positive integer:')
n=int(n)

count=0
for i in range(1,n+1):
    count += n//5**i #pow(5,i)

print(' Number of trailing zeros in factorial(',n,'):', count)
print(' Factorial (',n,')=',math.factorial(n))


\end{lstlisting} 


\end{document}
